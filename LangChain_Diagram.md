# LangChain Diagrams

This document contains visual representations of LangChain's architecture, components, and workflows. These diagrams help visualize how LangChain works and how its various components interact.

## Core Component Diagram

```
┌─────────────────────────────────────────────────────────────────┐
│                       LangChain Framework                        │
├─────────────┬─────────────┬────────────────┬───────────────────┤
│             │             │                │                   │
│   Models    │   Prompts   │   Retrievers   │      Agents       │
│             │             │                │                   │
├─────────────┼─────────────┼────────────────┼───────────────────┤
│             │             │                │                   │
│   Memory    │   Chains    │  Embeddings    │      Tools        │
│             │             │                │                   │
└─────────────┴─────────────┴────────────────┴───────────────────┘
```

## LangChain Layered Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                         Applications                             │
└───────────────────────────────┬─────────────────────────────────┘
                                │
┌───────────────────────────────┴─────────────────────────────────┐
│                            Agents                                │
└───────────────────────────────┬─────────────────────────────────┘
                                │
┌───────────────────────────────┴─────────────────────────────────┐
│                            Chains                                │
└───────────────────────────────┬─────────────────────────────────┘
                                │
┌───────────────────────────────┴─────────────────────────────────┐
│           Indexes             │            Memory                │
└───────────────────────────────┼─────────────────────────────────┘
                                │
┌───────────────────────────────┴─────────────────────────────────┐
│                           Prompts                                │
└───────────────────────────────┬─────────────────────────────────┘
                                │
┌───────────────────────────────┴─────────────────────────────────┐
│                            Models                                │
└─────────────────────────────────────────────────────────────────┘
```

## LLM Chain Flow Diagram

```
┌───────────┐     ┌──────────────┐     ┌─────────┐     ┌──────────┐
│           │     │              │     │         │     │          │
│   Input   ├────►│    Prompt    ├────►│   LLM   ├────►│  Output  │
│           │     │   Template   │     │         │     │          │
└───────────┘     └──────────────┘     └─────────┘     └──────────┘
```

## Retrieval-Augmented Generation (RAG) Flow

```
                  ┌───────────────────┐
                  │                   │
                  │     Document      │
                  │      Store        │
                  │                   │
                  └─────────┬─────────┘
                            │
                            ▼
┌───────────┐     ┌─────────────────┐     ┌───────────────┐
│           │     │                 │     │               │
│   Query   ├────►│    Retriever    ├────►│  Relevant     │
│           │     │                 │     │  Documents    │
└───────────┘     └─────────────────┘     └───────┬───────┘
                                                  │
                                                  ▼
┌───────────────────────────┐     ┌─────────┐     ┌───────────────┐
│                           │     │         │     │               │
│  Context-Enriched Prompt  │◄───┤  Prompt  │◄────┤  User Query   │
│                           │     │         │     │               │
└──────────────┬────────────┘     └─────────┘     └───────────────┘
               │
               ▼
      ┌─────────────────┐     ┌────────────────┐
      │                 │     │                │
      │      LLM        ├────►│     Response   │
      │                 │     │                │
      └─────────────────┘     └────────────────┘
```

## Agent System Architecture

```
                 ┌───────────────────────────┐
                 │                           │
                 │         Agent             │
                 │                           │
                 └─────────┬─────────────────┘
                           │
              ┌────────────┴───────────┐
              │                        │
┌─────────────▼─────┐         ┌────────▼───────────┐
│                   │         │                    │
│   Reasoning       │         │     Tool Usage     │
│   (LLM)           │         │                    │
│                   │         │                    │
└─────────┬─────────┘         └──┬────────────────┘
          │                      │
          │                      │
┌─────────▼─────────┐   ┌────────▼───────────┐
│                   │   │                    │
│  Action Planning  │   │  Tool Execution    │
│                   │   │                    │
└─────────┬─────────┘   └──┬─────────────────┘
          │                │
          └────────────────┘
                 │
      ┌──────────▼──────────┐
      │                     │
      │      Response       │
      │                     │
      └─────────────────────┘
```

## Memory Systems in LangChain

```
┌──────────────────────────────────────────────────────────────────┐
│                         Memory Types                              │
├──────────────┬──────────────┬───────────────┬───────────────────┤
│              │              │               │                   │
│ Conversation │   Vector     │   Entity      │   Summary         │
│   Buffer     │   Store      │   Memory      │   Memory          │
│              │              │               │                   │
└──────────────┴──────────────┴───────────────┴───────────────────┘
                           │
┌──────────────────────────┴───────────────────────────────────────┐
│                        Memory Backends                            │
├──────────────┬──────────────┬───────────────┬───────────────────┤
│              │              │               │                   │
│  In-Memory   │    Files     │   Databases   │  Cloud Storage    │
│              │              │               │                   │
└──────────────┴──────────────┴───────────────┴───────────────────┘
```

## Document Processing Pipeline

```
┌───────────────┐     ┌────────────────┐     ┌─────────────────┐
│               │     │                │     │                 │
│   Document    ├────►│  Text Splitter  ├────►│   Chunked Text  │
│   Loader      │     │                │     │                 │
└───────────────┘     └────────────────┘     └────────┬────────┘
                                                      │
                                                      ▼
                                            ┌─────────────────┐
                                            │                 │
                                            │   Embedding     │
                                            │   Model         │
                                            │                 │
                                            └────────┬────────┘
                                                     │
                                                     ▼
                                            ┌─────────────────┐
                                            │                 │
                                            │  Vector Store   │
                                            │                 │
                                            └─────────────────┘
```

## LangChain Expression Language (LCEL) Flow

```
┌────────────┐   ┌────────────┐   ┌────────────┐   ┌────────────┐
│            │   │            │   │            │   │            │
│ Component1 ├──►│ Component2 ├──►│ Component3 ├──►│ Component4 │
│            │   │            │   │            │   │            │
└────────────┘   └────────────┘   └────────────┘   └────────────┘

                        │
                        ▼

┌───────────────────────────────────────────────────────────────┐
│                                                               │
│  chain = Component1 | Component2 | Component3 | Component4    │
│                                                               │
└───────────────────────────────────────────────────────────────┘
```

## Typical QA System Architecture with LangChain

```
 User Question
      │
      ▼
┌────────────────┐
│                │
│  Preprocessor  │
│                │
└────────┬───────┘
         │
         ▼
┌────────────────┐    ┌─────────────────┐    ┌────────────────┐
│                │    │                 │    │                │
│   Retriever    │◄───┤   Vector Store  │◄───┤  Document DB   │
│                │    │                 │    │                │
└────────┬───────┘    └─────────────────┘    └────────────────┘
         │
         ▼
┌────────────────┐
│                │
│  Context       │
│  Generation    │
│                │
└────────┬───────┘
         │
         ▼
┌────────────────┐
│                │
│  Prompt        │
│  Construction  │
│                │
└────────┬───────┘
         │
         ▼
┌────────────────┐
│                │
│  LLM           │
│                │
└────────┬───────┘
         │
         ▼
┌────────────────┐
│                │
│  Response      │
│  Generation    │
│                │
└────────┬───────┘
         │
         ▼
     Answer
```

## Multi-Agent System Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│                        Orchestrator Agent                       │
│                                                                 │
└───┬───────────────────────┬───────────────────────┬────────────┘
    │                       │                       │
    ▼                       ▼                       ▼
┌─────────────┐      ┌─────────────┐         ┌─────────────┐
│             │      │             │         │             │
│ Research    │      │ Planning    │         │ Execution   │
│ Agent       │      │ Agent       │         │ Agent       │
│             │      │             │         │             │
└──┬──────────┘      └──┬──────────┘         └──┬──────────┘
   │                    │                       │
   ▼                    ▼                       ▼
┌─────────────┐      ┌─────────────┐         ┌─────────────┐
│             │      │             │         │             │
│ Knowledge   │      │ Task        │         │ Tool        │
│ Base        │      │ Queue       │         │ Set         │
│             │      │             │         │             │
└─────────────┘      └─────────────┘         └─────────────┘
```

## Retrieval Methods Comparison

```
┌─────────────────────────────────────────────────────────────────┐
│                      Retrieval Methods                           │
├────────────────┬──────────────────┬────────────────────────────┤
│                │                  │                            │
│ Similarity     │ Hybrid           │ Self-Query                 │
│ Search         │ Search           │ Retrieval                  │
│                │                  │                            │
├────────────────┴──────────────────┴────────────────────────────┤
│                                                                │
│                   Performance Characteristics                   │
├────────────────┬──────────────────┬────────────────────────────┤
│                │                  │                            │
│ Semantic       │ Keyword +        │ Natural Language           │
│ Matching       │ Semantic         │ Query Understanding        │
│                │                  │                            │
└────────────────┴──────────────────┴────────────────────────────┘
```

## Integration Points Diagram

```
                  ┌───────────────────────┐
                  │                       │
                  │    LangChain Core     │
                  │                       │
                  └───┬───────────────┬───┘
                      │               │
        ┌─────────────┘               └──────────────┐
        │                                            │
┌───────▼──────────┐                      ┌──────────▼─────────┐
│                  │                      │                    │
│  Model           │                      │  Storage           │
│  Providers       │                      │  Providers         │
│                  │                      │                    │
└──────────────────┘                      └────────────────────┘
   │                                            │
   ▼                                            ▼
┌──────────────────┐                      ┌────────────────────┐
│ OpenAI           │                      │ Pinecone           │
│ Anthropic        │                      │ Chroma             │
│ Hugging Face     │                      │ FAISS              │
│ Google           │                      │ Weaviate           │
│ Azure            │                      │ Qdrant             │
│ Cohere           │                      │ MongoDB            │
└──────────────────┘                      └────────────────────┘
                                        
                    ┌───────────────┐
                    │               │
                    │  Document     │
                    │  Loaders      │
                    │               │
                    └───────────────┘
                             │
                             ▼
                    ┌───────────────┐
                    │ PDF           │
                    │ HTML          │
                    │ JSON          │
                    │ CSV           │
                    │ Markdown      │
                    │ Notion        │
                    │ Google Drive  │
                    └───────────────┘
```

## LangChain Tool Ecosystem

```
┌─────────────────────────────────────────────────────────────────┐
│                          Tool Types                              │
├─────────────┬─────────────┬────────────────┬───────────────────┤
│             │             │                │                   │
│  Search     │   REPL      │   Structured   │     API           │
│  Tools      │   Tools     │   Output       │     Tools         │
│             │             │   Tools        │                   │
├─────────────┼─────────────┼────────────────┼───────────────────┤
│             │             │                │                   │
│  Human      │   Shell     │   Database     │     File          │
│  Tools      │   Tools     │   Tools        │     Tools         │
│             │             │                │                   │
└─────────────┴─────────────┴────────────────┴───────────────────┘
```

## Chain Types and Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                          Chain Types                             │
├─────────────┬─────────────┬────────────────┬───────────────────┤
│             │             │                │                   │
│  LLM        │  Sequential │   Router       │     QA            │
│  Chain      │   Chain     │   Chain        │     Chain         │
│             │             │                │                   │
├─────────────┼─────────────┼────────────────┼───────────────────┤
│             │             │                │                   │
│  Retrieval  │  MapReduce  │   Refine       │     Transform     │
│  Chain      │   Chain     │   Chain        │     Chain         │
│             │             │                │                   │
└─────────────┴─────────────┴────────────────┴───────────────────┘
```

## RAG System Extended Architecture

```
Offline Processing:
┌───────────────┐     ┌────────────────┐     ┌─────────────────┐
│               │     │                │     │                 │
│   Document    ├────►│  Text Splitter  ├────►│   Text Chunks   │
│   Sources     │     │                │     │                 │
└───────────────┘     └────────────────┘     └────────┬────────┘
                                                      │
                                                      ▼
                                            ┌─────────────────┐
                                            │                 │
                                            │   Metadata      │
                                            │   Enrichment    │
                                            │                 │
                                            └────────┬────────┘
                                                     │
                                                     ▼
                                            ┌─────────────────┐
                                            │                 │
                                            │  Embedding      │
                                            │  Generation     │
                                            │                 │
                                            └────────┬────────┘
                                                     │
                                                     ▼
                                            ┌─────────────────┐
                                            │                 │
                                            │  Vector Store   │
                                            │  Indexing       │
                                            │                 │
                                            └─────────────────┘

Runtime Query Processing:
┌───────────────┐     ┌────────────────┐     ┌─────────────────┐
│               │     │                │     │                 │
│   User        ├────►│  Query         ├────►│   Query         │
│   Query       │     │  Understanding │     │   Embedding     │
└───────────────┘     └────────────────┘     └────────┬────────┘
                                                      │
                                                      ▼
                                            ┌─────────────────┐
                                            │                 │
                                            │   Vector        │
                                            │   Search        │
                                            │                 │
                                            └────────┬────────┘
                                                     │
                                                     ▼
                                            ┌─────────────────┐
                                            │                 │
                                            │  Re-ranking     │
                                            │                 │
                                            └────────┬────────┘
                                                     │
                                                     ▼
                                            ┌─────────────────┐
                                            │                 │
                                            │  Context        │
                                            │  Construction   │
                                            │                 │
                                            └────────┬────────┘
                                                     │
                                                     ▼
                                            ┌─────────────────┐
                                            │                 │
                                            │  LLM            │
                                            │  Generation     │
                                            │                 │
                                            └────────┬────────┘
                                                     │
                                                     ▼
                                            ┌─────────────────┐
                                            │                 │
                                            │  Response       │
                                            │                 │
                                            └─────────────────┘
```

## Advanced LangChain Components Interaction

```
┌────────────────────────────────────────────────────────────────┐
│                                                                │
│                       LangChain Application                     │
│                                                                │
└────────────────────────────┬───────────────────────────────────┘
                             │
                 ┌───────────┴───────────┐
                 │                       │
    ┌────────────▼──────────┐   ┌────────▼───────────┐
    │                       │   │                    │
    │      Chains           │   │     Agents         │
    │                       │   │                    │
    └────────────┬──────────┘   └────────┬───────────┘
                 │                       │
                 │                       │
    ┌────────────▼──────────┐   ┌────────▼───────────┐
    │                       │   │                    │
    │      Retrievers       │   │     Tools          │
    │                       │   │                    │
    └────────────┬──────────┘   └────────┬───────────┘
                 │                       │
                 │                       │
    ┌────────────▼──────────┐   ┌────────▼───────────┐
    │                       │   │                    │
    │      Memory           │   │     Embeddings     │
    │                       │   │                    │
    └────────────┬──────────┘   └────────┬───────────┘
                 │                       │
                 └───────────┬───────────┘
                             │
                  ┌──────────▼─────────┐
                  │                    │
                  │      Models        │
                  │                    │
                  └────────────────────┘
```

## Event-Based Monitoring with LangSmith

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│                          LangChain App                          │
│                                                                 │
└───────────────────────────┬─────────────────────────────────────┘
                            │
                            │ Emits Events
                            ▼
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│                          LangSmith                              │
│                                                                 │
├─────────────┬─────────────┬────────────────┬───────────────────┤
│             │             │                │                   │
│  Traces     │  Feedback   │   Datasets     │     Evaluation    │
│             │             │                │                   │
└─────────────┴─────────────┴────────────────┴───────────────────┘
```

## Different Types of Chains

### LLMChain
```
Input → Prompt Template → LLM → Output
```

### Sequential Chain
```
Input → Chain1 → Output1 → Chain2 → Output2 → ... → ChainN → Final Output
```

### Router Chain
```
                    ┌─────► Chain1 ─────┐
                    │                   │
Input → Routing LLM ├─────► Chain2 ─────┤ → Output
                    │                   │
                    └─────► Chain3 ─────┘
```

### Retrieval QA Chain
```
Question ──────────────────────┐
                               │
                               ▼
Document DB → Retriever → Retrieved Docs → Context Construction
                                               │
                                               ▼
                                       Prompt Template
                                               │
                                               ▼
                                             LLM
                                               │
                                               ▼
                                            Answer
```

## Memory Types and Their Use Cases

```
┌─────────────────────────────────────────────────────────────────┐
│                        Memory Types                              │
├───────────────┬───────────────────────┬──────────────────────────┤
│ Type          │ Description           │ Use Cases                │
├───────────────┼───────────────────────┼──────────────────────────┤
│ Buffer Memory │ Stores raw history    │ Simple chatbots          │
├───────────────┼───────────────────────┼──────────────────────────┤
│ Summary       │ Keeps compressed      │ Long conversations       │
│ Memory        │ history               │                          │
├───────────────┼───────────────────────┼──────────────────────────┤
│ Vector Store  │ Stores embeddings     │ Semantic search in       │
│ Memory        │ of conversations      │ conversation history     │
├───────────────┼───────────────────────┼──────────────────────────┤
│ Entity Memory │ Tracks information    │ Personalized             │
│               │ about entities        │ interactions             │
├───────────────┼───────────────────────┼──────────────────────────┤
│ Conversation  │ Manages messages      │ Multi-turn               │
│ Token Buffer  │ within token limits   │ conversations            │
└───────────────┴───────────────────────┴──────────────────────────┘
```

## Core Abstractions in LangChain

```
┌─────────────────────────────────────────────────────────────────┐
│                     Core LangChain Abstractions                  │
├─────────────┬─────────────┬────────────────┬───────────────────┤
│             │             │                │                   │
│  Model      │  Prompt     │   Index        │     Chain         │
│             │             │                │                   │
├─────────────┼─────────────┼────────────────┼───────────────────┤
│             │             │                │                   │
│  Memory     │  Retriever  │   Embedding    │     Agent         │
│             │             │                │                   │
└─────────────┴─────────────┴────────────────┴───────────────────┘
```

These diagrams provide a comprehensive visual understanding of LangChain's architecture, components, and workflows. They can be used to understand how LangChain works, plan applications, and communicate design concepts to team members.
